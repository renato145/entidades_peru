(this.webpackJsonpentidades_peru=this.webpackJsonpentidades_peru||[]).push([[0],{169:function(e,t,n){},172:function(e,t,n){},173:function(e,t,n){"use strict";n.r(t);var a=n(0),c=n.n(a),r=n(72),s=n.n(r),i=(n(169),n(6)),o=n(7),l=n(4),u=n(2),d=n(8),b=n.n(d),j=n(5),m=n(19),O=n(74),f=Object(i.atom)(Object(m.a)(b.a.mark((function e(){var t,n,a;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(l.a)("poblacion_departamentos.csv",(function(e){return Object(j.a)(Object(j.a)({},e),{},{total:+e.total})}));case 2:return t=e.sent,n=new Map,a=0,t.forEach((function(e){var t=e.departamento,c=e.total;a+=c,n.set(t,c)})),n.set("all",a),e.abrupt("return",n);case 8:case"end":return e.stop()}}),e)})))),x=function(e){var t,n=Object(l.k)(e,(function(e){return e.length}),(function(e){return e.poder})).sort((function(e,t){return Object(l.b)(e[1],t[1])}));return{entries:n,total:Object(l.m)(n.map((function(e){return e[1]}))),max:null!==(t=Object(l.i)(n.map((function(e){return e[1]}))))&&void 0!==t?t:0}},h=Object(i.atom)(Object(m.a)(b.a.mark((function e(){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(l.a)("entidades.csv",(function(e){return e}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))),p=1e5,g=Object(i.atom)((function(e){var t=e(f),n=Object(l.k)(e(h),x,(function(e){return e.departamento})),a=new Map;return n.forEach((function(e){var n,c=Object(u.a)(e,2),r=c[0],s=c[1],i=null!==(n=t.get(r))&&void 0!==n?n:0;return a.set(r,Object(j.a)(Object(j.a)({},s),{},{population:i,density:s.total/i*p}))})),a})),v=Object(i.atom)((function(e){var t,n=x(e(h)),a=null!==(t=e(f).get("all"))&&void 0!==t?t:0;return Object(j.a)(Object(j.a)({},n),{},{population:a,density:n.total/a*p})})),y=Object(i.atom)(Object(m.a)(b.a.mark((function e(){var t;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(l.g)("departamentos.json").then((function(e){return Object(O.a)(e,"departamentos")}));case 2:return t=e.sent,e.abrupt("return",t);case 4:case"end":return e.stop()}}),e)})))),w=Object(i.atom)(null),N=Object(i.atom)((function(e){var t=e(w);if(null===t)return null;var n=e(g).get(t);return void 0===n?null:Object(j.a)({name:t},n)})),k=Object(i.atom)("density"),A=Object(i.atom)((function(e){var t=e(g),n=e(k),a=Object(l.i)(Object(l.h)(t.values(),(function(e){var t=e.total,a=e.density;return"number"===n?t:a})));return null!==a&&void 0!==a?a:0})),V=n(1),M=function(e){var t=e.departamento,n=e.path,c=e.scale,r=Object(a.useMemo)((function(){var e;return{selectionStatusAtom:(e=t,Object(i.atom)((function(t){var n=t(w);return null===n?"empty":n===e?"selected":"other"}))),departamentoDataAtom:function(e){return Object(i.atom)((function(t){return t(g).get(e)}))}(t)}}),[t]),s=r.selectionStatusAtom,l=r.departamentoDataAtom,u=Object(o.useAtomValue)(s),d=Object(o.useAtomValue)(l),b=Object(o.useUpdateAtom)(w),j=Object(o.useAtomValue)(k),m=c(void 0===d?0:"number"===j?d.total:d.density);return Object(V.jsx)("path",{className:"stroke-current text-gray-700 ".concat("selected"===u?"selected-land stroke-[3px]":"other"===u?"opacity-25":""),transform:"Callao"===t?"scale(4),translate(-140,-384)":"",style:"Callao"!==t?{}:{strokeWidth:"selected"===u?.7:.3},fill:m,d:n,onPointerEnter:function(){return b(t)},onPointerLeave:function(){return b(null)}})},S=function(e){return e<20?"start":e>80?"end":"middle"},P=function(e,t){return"number"===t?e:e.toFixed(1)},z=function(e){var t=e.mapSize,n=e.legendSize,c=e.legendMargins,r=e.scale,s=e.orientation,i=void 0===s?"horizontal":s,d=e.ticks,b=void 0===d?0:d,j=e.tickHeight,m=void 0===j?8:j,O=e.textOffset,f=void 0===O?15:O,x=Object(a.useMemo)((function(){return"colorLegendGradient".concat(Math.round(1e4*Math.random()))}),[]),h=r.domain(),p=Object(u.a)(h,2),g=p[0],v=p[1],y=Object(o.useAtomValue)(N),w=Object(o.useAtomValue)(k),A=null===y?0:"number"===w?y.total:y.density,M=(A-g)/v*100,z=M*n.width/100;return Object(V.jsxs)("g",{children:[Object(V.jsx)("linearGradient",{id:x,gradientTransform:"rotate(".concat("horizontal"===i?0:90,")"),children:Object(l.j)(0,100.01,20).map((function(e,t){return Object(V.jsx)("stop",{offset:"".concat(e,"%"),stopColor:r((g+e*(v-g))/100)},t)}))}),Object(V.jsxs)("g",{transform:"translate(".concat(c.left,",").concat(t.height+c.top,")"),children:[Object(V.jsx)("text",{x:2,y:-7,className:"text-lg tracking-wide text-gray-800 fill-current font-semibold",children:"number"===w?"Nro de entidades":"Nro de entidades por 100mil habitantes"}),Object(V.jsx)("rect",{width:n.width,height:n.height,fill:"url(#".concat(x,")"),className:"text-gray-800 stroke-current"}),Object(V.jsxs)("g",{transform:"translate(0, ".concat(n.height+c.bottom,")"),children:[Object(l.j)(0,100.01,100/(1+b)).map((function(e,t){var a=e*n.width/100;return Object(V.jsxs)("g",{opacity:null===y?1:.2,children:[Object(V.jsx)("line",{x1:a,x2:a,y1:0,y2:m,className:"text-gray-800 stroke-current"}),Object(V.jsx)("text",{x:a,y:m+f,textAnchor:S(e),className:"text-sm text-gray-800 font-semibold fill-current",children:P(g+e/100*(v-g),w)})]},t)})),Object(V.jsxs)("g",{opacity:null===y?0:1,className:"transition-opacity",children:[Object(V.jsx)("line",{transform:"translate(".concat(z,",",0,")"),y1:0,y2:m,className:"text-gray-800 stroke-current transition-transform"}),Object(V.jsx)("text",{transform:"translate(".concat(z,",",0,")"),y:m+f,textAnchor:S(M),className:"text-gray-800 fill-current font-semibold transition-transform",children:null!==y?"".concat(y.name," (").concat(P(A,w),")"):""})]})]})]})]})},F=(n(172),{width:540,height:800}),C={width:F.width,height:F.height+75},E={left:20,right:20,top:10,bottom:0},L={width:C.width-E.left-E.right,height:30},B=function(){var e=Object(o.useAtomValue)(y),t=Object(o.useAtomValue)(A),n=Object(a.useMemo)((function(){var t=Object(l.d)().fitSize([F.width,F.height],e);return Object(l.e)(t)}),[e]),c=Object(a.useMemo)((function(){return Object(l.l)().domain([0,t]).interpolator(l.f)}),[t]);return Object(V.jsxs)("svg",{className:"max-w-[400px] max-h-[650px]",viewBox:"0 0 ".concat(C.width," ").concat(C.height),children:[e.features.map((function(e,t){return Object(V.jsx)(M,{departamento:e.properties.departamento,path:n(e),scale:c},t)})),Object(V.jsx)(z,{mapSize:F,legendSize:L,legendMargins:E,scale:c})]})},D=Object(l.c)(","),_=function(e){var t=Object.assign({},e),n=Object(o.useAtomValue)(w),a=Object(o.useAtomValue)(N),c=Object(o.useAtomValue)(v),r=null!==a&&void 0!==a?a:c;return Object(V.jsxs)("div",Object(j.a)(Object(j.a)({},t),{},{children:[Object(V.jsxs)("p",{className:"text-2xl font-semibold",children:[null!==n&&void 0!==n?n:"Per\xfa",": ",D(r.total)," entidades"]}),Object(V.jsxs)("p",{className:"text-sm tracking-wide font-semibold text-gray-500",children:[r.density.toFixed(1)," entidades por cada 100mil habitantes"]}),Object(V.jsx)("div",{className:"mt-3 w-full flex flex-col space-y-2",children:r.entries.map((function(e,t){var n=Object(u.a)(e,2),a=n[0],c=n[1];return Object(V.jsxs)("div",{children:[Object(V.jsxs)("p",{className:"text-sm text-gray-800 font-medium tracking-wide",children:[a," (",c,")"]}),Object(V.jsx)("div",{className:"bg-blue-900 h-5",style:{width:"".concat(100*c/r.max,"%")}})]},t)}))})]}))},G=n(75),H=["className","children","type"],I=function(e){e.className;var t=e.children,n=(e.type,Object(G.a)(e,H));return Object(V.jsx)("button",Object(j.a)(Object(j.a)({className:"px-2 py-2 bg-blue-400 disabled:bg-blue-500 hover:bg-blue-600 active:bg-blue-800 shadow rounded text-white tracking-wide focus:outline-none focus:ring disabled:ring-4 disabled:ring-blue-800 transition"},n),{},{children:t}))},J=function(e){var t=Object(i.useAtom)(k),n=Object(u.a)(t,2),a=n[0],c=n[1];return Object(V.jsx)("div",Object(j.a)(Object(j.a)({},e),{},{children:Object(V.jsxs)("div",{className:"flex flex-col space-y-2",children:[Object(V.jsx)(I,{onClick:function(){return c("number")},disabled:"number"===a,children:"Visualizar por n\xfamero de entidades"}),Object(V.jsxs)(I,{onClick:function(){return c("density")},disabled:"density"===a,children:[Object(V.jsx)("p",{children:"Visualizar por densidad"}),"(entidades por cada 100mil habitantes)"]})]})}))},T=["Departamento","Habitantes","#Entidades","#Entidades por\n100mil habitantes"],W=Object(l.c)(","),U=function(e){var t=Object(i.useAtom)(w),n=Object(u.a)(t,2),a=n[0],c=n[1],r="number"===Object(o.useAtomValue)(k)?2:3,s=Array.from(Object(o.useAtomValue)(g)).map((function(e){var t=Object(u.a)(e,2),n=t[0],a=t[1];return[n,a.population,a.total,a.density]})).sort((function(e,t){return Object(l.b)(e[r],t[r])}));return Object(V.jsx)("div",Object(j.a)(Object(j.a)({},e),{},{children:Object(V.jsxs)("table",{className:"table-auto border border-blue-100",children:[Object(V.jsx)("thead",{children:Object(V.jsx)("tr",{children:T.map((function(e,t){return Object(V.jsx)("th",{className:"px-3 py-2 bg-blue-500 text-white font-medium tracking-wide whitespace-pre-line ".concat(0===t?"rounded-tl-lg":t===T.length-1?"rounded-tr-lg":""),children:e},t)}))})}),Object(V.jsx)("tbody",{children:s.map((function(e,t){return Object(V.jsx)("tr",{className:"".concat(e[0]===a?"bg-blue-900 text-white":t%2===0?"bg-blue-100":"bg-gray-50"," cursor-default"),onPointerEnter:function(){return c(e[0])},onPointerLeave:function(){return c(null)},children:e.map((function(e,t){return Object(V.jsx)("td",{className:"px-3 py-1.5 ".concat(0===t?"text-left":"text-right"),children:1===t?W(e):3===t?e.toFixed(2):e},t)}))},t)}))})]})}))},X=n(175),q=n(73),K=[["Lista de entidades","https://www.datosabiertos.gob.pe/dataset/lista-de-entidades-del-estado-peruano"],["Poblaci\xf3n","https://cloud.minsa.gob.pe/apps/onlyoffice/s/XJ3NoG3WsxgF6H8?fileId=613439"],["Shapefiles","https://www.geogpsperu.com/2014/03/base-de-datos-peru-shapefile-shp-minam.html"]],Q=function(e){return Object(V.jsx)("div",Object(j.a)(Object(j.a)({},e),{},{children:Object(V.jsx)(X.a,{children:function(e){var t=e.open;return Object(V.jsxs)(V.Fragment,{children:[Object(V.jsxs)(X.a.Button,{className:"self-end flex hover:underline focus:outline-none focus-visible:outline-none focus-visible:ring focus-visible:ring-blue-500 focus-visible:ring-opacity-50",children:[Object(V.jsx)("span",{children:"Ver informaci\xf3n acerca de las fuentes de datos"}),Object(V.jsx)(q.a,{className:"".concat(t?"rotate-180":""," ml-1 mt-1 w-4 h-4 transition-transform")})]}),Object(V.jsx)(X.a.Panel,{className:"mt-1 mb-0.5 pl-6 pr-2 py-2.5 bg-gray-200 ring-2 ring-gray-300 rounded-lg shadow",children:Object(V.jsx)("ul",{className:"list-decimal space-y-2 break-all",children:K.map((function(e,t){var n=Object(u.a)(e,2),a=n[0],c=n[1];return Object(V.jsxs)("li",{children:[a,":"," ",Object(V.jsx)("a",{href:c,target:"_black",rel:"noopener",children:c})]},t)}))})})]})}})}))},R=function(){return Object(V.jsx)(i.Provider,{children:Object(V.jsxs)("div",{className:"container mx-auto mt-4",children:[Object(V.jsx)("h1",{className:"text-center text-4xl font-semibold",children:"Entidades del estado peruano"}),Object(V.jsx)(a.Suspense,{fallback:Object(V.jsx)("p",{children:"Loading..."}),children:Object(V.jsx)("div",{className:"mt-8 p-2 flex flex-col",children:Object(V.jsxs)("div",{className:"flex flex-wrap justify-evenly",children:[Object(V.jsx)(B,{}),Object(V.jsxs)("div",{className:"mt-1 flex-1 flex flex-wrap flex-col max-w-[300px] min-w-[200px]",children:[Object(V.jsx)(J,{}),Object(V.jsx)(_,{className:"mt-6"})]}),Object(V.jsxs)("div",{className:"flex flex-col",children:[Object(V.jsx)(Q,{className:"flex flex-col w-full max-w-md"}),Object(V.jsx)(U,{})]})]})})})]})})},Y=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,176)).then((function(t){var n=t.getCLS,a=t.getFID,c=t.getFCP,r=t.getLCP,s=t.getTTFB;n(e),a(e),c(e),r(e),s(e)}))};s.a.render(Object(V.jsx)(c.a.StrictMode,{children:Object(V.jsx)(R,{})}),document.getElementById("root")),Y()}},[[173,1,2]]]);
//# sourceMappingURL=main.d70e80f3.chunk.js.map